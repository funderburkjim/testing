# Compare scharfsandhi and Bucknell
Reference: Sanskrit Manual: A Quick Reference Guide to Phonology and Grammar of Classical Sanskrit  by Roderick S. Bucknell.

On pages 74 and 75, Bucknell presents rules of external sandhi.

The rules are prsented in the form of two tables, one for combining word-final vowel with a word beginning vowel, and
one for combining a word-final consonant with a word-beginning consonant or vowel. The following are close representations
of the printed tables.

### Word-final vowels (SLP1)
<table>
 <tr>
  <td><b>-a/-A</b></td>
  <td><b>-i/-I</b></td>
  <td><b>-u/-U</b></td>
  <td><b>-f</b></td>
  <td><b>-O</b></td>
  <td><b>-E</b></td>
  <td><b>-e</b></td>
  <td><b>-o</b></td>
  <td><b>C-<sup>8</sup></b></td>
 </tr>
 <tr>
  <td>-A-</td>
  <td>-ya-</td>
  <td>-va-</td>
  <td>-ra-</td>
  <td>-Ava-</td>
  <td>-A a-</td>
  <td>-e '-</td>
  <td>-o '-</td>
  <td><b>a-</b></td>
 </tr>
 <tr>
  <td>-A-</td>
  <td>-yA-</td>
  <td>-vA-</td>
  <td>-rA-</td>
  <td>-AvA-</td>
  <td>-A A-</td>
  <td>-a A-</td>
  <td>-a A-</td>
  <td><b>A-</b></td>
 </tr>
 <tr>
  <td>-e-</td>
  <td>-I-</td>
  <td>-vi-</td>
  <td>-ri-</td>
  <td>-Avi-</td>
  <td>-A i-</td>
  <td>-a i-</td>
  <td>-a i-</td>
  <td><b>i-</b></td>
 </tr>
 <tr>
  <td>-e-</td>
  <td>-I-</td>
  <td>-vI-</td>
  <td>-rI-</td>
  <td>-AvI-</td>
  <td>-A I-</td>
  <td>-a I-</td>
  <td>-a I-</td>
  <td><b>I-</b></td>
 </tr>
 <tr>
  <td>-o-</td>
  <td>-yu-</td>
  <td>-U-</td>
  <td>-ru-</td>
  <td>-Avu-</td>
  <td>-A u-</td>
  <td>-a u-</td>
  <td>-a u-</td>
  <td><b>u-</b></td>
 </tr>
 <tr>
  <td>-o-</td>
  <td>-yU-</td>
  <td>-U-</td>
  <td>-rU-</td>
  <td>-AvU-</td>
  <td>-A U-</td>
  <td>-a U-</td>
  <td>-a U-</td>
  <td><b>U-</b></td>
 </tr>
 <tr>
  <td>-ar-</td>
  <td>-yf-</td>
  <td>-vf-</td>
  <td>-F-</td>
  <td>-Avf-</td>
  <td>-A f-</td>
  <td>-a f-</td>
  <td>-a f-</td>
  <td><b>f-</b></td>
 </tr>
 <tr>
  <td>-E-</td>
  <td>-ye-</td>
  <td>-ve-</td>
  <td>-re-</td>
  <td>-Ave-</td>
  <td>-A e-</td>
  <td>-a e-</td>
  <td>-a e-</td>
  <td><b>e-</b></td>
 </tr>
 <tr>
  <td>-E-</td>
  <td>-yE-</td>
  <td>-vE-</td>
  <td>-rE-</td>
  <td>-AvE-</td>
  <td>-A E-</td>
  <td>-a E-</td>
  <td>-a E-</td>
  <td><b>E-</b></td>
 </tr>
 <tr>
  <td>-O-</td>
  <td>-yo-</td>
  <td>-vo-</td>
  <td>-ro-</td>
  <td>-Avo-</td>
  <td>-A o-</td>
  <td>-a o-</td>
  <td>-a o-</td>
  <td><b>o-</b></td>
 </tr>
 <tr>
  <td>-O-</td>
  <td>-yO-</td>
  <td>-vO-</td>
  <td>-rO-</td>
  <td>-AvO-</td>
  <td>-A O-</td>
  <td>-a O-</td>
  <td>-a o-</td>
  <td><b>O-</b></td>
 </tr>
</table>

Footnote 8: C denotes any consonant. When the preceding word ends in a short vowel, c -> C

### Word-final consonants (SLP1)
<table>
 <tr>
  <td><b>k</b></td>
  <td><b>w</b></td>
  <td><b>t</b></td>
  <td><b>p</b></td>
  <td><b>N</b></td>
  <td><b>m</b></td>
  <td><b>n</b></td>
  <td><b>aH</b></td>
  <td><b>AH</b></td>
  <td><b>iH<sup>1</sup></b></td>
  <td><b>IH<sup>2</sup></b></td>
  <td><b><sup>0</sup></b></td>
 </tr>
 <tr>
  <td>k</td>
  <td>w</td>
  <td>t</td>
  <td>p</td>
  <td>N</td>
  <td>M</td>
  <td>n</td>
  <td>aH<sup>3</sup></td>
  <td>AH<sup>3</sup></td>
  <td>iH<sup>3</sup></td>
  <td>IH<sup>3</sup></td>
  <td><b>k K p P z s</b></td>
 </tr>
 <tr>
  <td>k</td>
  <td>w</td>
  <td>c*</td>
  <td>p</td>
  <td>N</td>
  <td>M</td>
  <td>Y*</td>
  <td>aH<sup>3</sup></td>
  <td>AH<sup>3</sup></td>
  <td>iH<sup>3</sup></td>
  <td>IH<sup>3</sup></td>
  <td><b>S {*S->C}<sup>4</sup> {*S->C}</b></td>
 </tr>
 <tr>
  <td>k</td>
  <td>w</td>
  <td>c</td>
  <td>p</td>
  <td>N</td>
  <td>M</td>
  <td>MS</td>
  <td>aS</td>
  <td>AS</td>
  <td>iS</td>
  <td>IS</td>
  <td><b>c C</b></td>
 </tr>
 <tr>
  <td>k</td>
  <td>w</td>
  <td>w</td>
  <td>p</td>
  <td>N</td>
  <td>M</td>
  <td>Mz</td>
  <td>az</td>
  <td>Az</td>
  <td>iz</td>
  <td>Iz</td>
  <td><b>w W</b></td>
 </tr>
 <tr>
  <td>k</td>
  <td>w</td>
  <td>t</td>
  <td>p</td>
  <td>N</td>
  <td>M</td>
  <td>Ms</td>
  <td>as</td>
  <td>As</td>
  <td>is</td>
  <td>Is</td>
  <td><b>t T</b></td>
 </tr>
 <tr>
  <td>g</td>
  <td>q</td>
  <td>d</td>
  <td>b</td>
  <td>N</td>
  <td>M</td>
  <td>n</td>
  <td>o</td>
  <td>A</td>
  <td>I</td>
  <td>I</td>
  <td><b>r</b></td>
 </tr>
 <tr>
  <td>g</td>
  <td>q</td>
  <td>d</td>
  <td>b</td>
  <td>N</td>
  <td>M</td>
  <td>n</td>
  <td>o</td>
  <td>A</td>
  <td>ir</td>
  <td>Ir</td>
  <td><b>g G d D b B y v</b></td>
 </tr>
 <tr>
  <td>g</td>
  <td>q</td>
  <td>j</td>
  <td>b</td>
  <td>N</td>
  <td>M</td>
  <td>Y</td>
  <td>o</td>
  <td>A</td>
  <td>ir</td>
  <td>Ir</td>
  <td><b>j J</b></td>
 </tr>
 <tr>
  <td>g</td>
  <td>q</td>
  <td>q</td>
  <td>b</td>
  <td>N</td>
  <td>M</td>
  <td>R</td>
  <td>o</td>
  <td>A</td>
  <td>ir</td>
  <td>Ir</td>
  <td><b>q Q</b></td>
 </tr>
 <tr>
  <td>g</td>
  <td>q</td>
  <td>l</td>
  <td>b</td>
  <td>N</td>
  <td>M</td>
  <td>M<sup>5</sup></td>
  <td>o</td>
  <td>A</td>
  <td>ir</td>
  <td>Ir</td>
  <td><b>l</b></td>
 </tr>
 <tr>
  <td>g*</td>
  <td>q*</td>
  <td>d*</td>
  <td>b*</td>
  <td>N</td>
  <td>M</td>
  <td>n</td>
  <td>o</td>
  <td>A</td>
  <td>ir</td>
  <td>Ir</td>
  <td><b>h {*h->G} {*h->Q} {*h->D} {*h->B}</b></td>
 </tr>
 <tr>
  <td>N</td>
  <td>R</td>
  <td>n</td>
  <td>m</td>
  <td>N</td>
  <td>M</td>
  <td>n</td>
  <td>o</td>
  <td>A</td>
  <td>ir</td>
  <td>Ir</td>
  <td><b>n m</b></td>
 </tr>
 <tr>
  <td>g</td>
  <td>q</td>
  <td>d</td>
  <td>b</td>
  <td>N<sup>6</sup></td>
  <td>m</td>
  <td>n<sup>6</sup></td>
  <td>o*</td>
  <td>A</td>
  <td>ir</td>
  <td>Ir</td>
  <td><b>a {*a->'}</b></td>
 </tr>
 <tr>
  <td>g</td>
  <td>q</td>
  <td>d</td>
  <td>b</td>
  <td>N<sup>6</sup></td>
  <td>m</td>
  <td>n<sup>6</sup></td>
  <td>a</td>
  <td>A</td>
  <td>ir</td>
  <td>Ir</td>
  <td><sup>7</sup> <b>A i I u U f O E e o</b></td>
 </tr>
</table>

Footnotes:

1. Similarly -uH
2. Similarly -UH, -eH, -oH, -EH, and -OH
3. -H may optionally assimilate before S-, z-, or s-; e.g. -H S -> -H S- *or* -> -S S-.
4. After -n, S- may remain unchanged; i.e. -n S- -> -Y C- *or* -> -Y S-
5. Alternatively, -n may change to -l (letter 'ell') (a nasalized l) when followwoed by l-; i.e. -n l- -> -M l- *or* -> -l~ l-
6. Word-final -n or -N, if preceded by a short vowel, is doubled before a following vowel; e.g. -in e- -> -inn e-.
7. Here V denotes any vowel other than a.


### Comparison implementation

* For each of the tables, a program constructs a corresponding input file
``` 
python prep_vowel.py E vowel_test.txt
python prep_consonant.py E1 consonant_test.txt

A sample element of vowel_test.txt is
E:a a:A
E:A a:A

These two correspond to the first row and first column of the vowel table above, and may be read:
"When a word ending in 'a' or 'A' is combined by External sandhi to a word beginning with 'a', then
 the ending letter and beginning letter coalesce into a single letter, 'A' "   (according to Bucknell).
 
```

* Bucknell's results are then compared to the result computed by scharfsandhi.py, using the test program
  ScharfSandhiTest2.py:
```
python ScharfSandhiTest2.py bucknell/vowel_test.txt > bucknell/log_vowel_test.txt
python ScharfSandhiTest2.py bucknell/consonant_test.txt > bucknell/log_consonant_test.txt
```

The two log files summarize the comparison. (see below for discussion)

### Implementation of Footnotes
* Footnotes 1 and 2 of the consonant table are expanded into multiple test cases, using the alternate vowels.
* Similarly, Footnote 7 has been expanded into a list of vowels (last row of consonant table)
* The other footnotes do not play a role in the implementation.

### Meaning of 'E1' option in consonant sandhi
scharfsandhi uses various run-time options when computing sandhi combinations.  Currently, there are four options,
which have been further summarized into groups of 'simple' options. Both 'E' and 'E1' represent external sandhi; 
the only difference is that (in consonant sandhi), the space is removed with option 'E' and retained with option 'E1' 
when (after sandhi) the first word still ends in a consonant.   Bucknell does not address this detail, so the comparison
between Bucknell and scharfsandhi was simplified by always leaving that space; that's why E1 was chosen for consonant sandhi.


### Summary of differences - consonant sandhi
This is a review of the log_consonant_test.txt summary file.

697 cases are derived from Bucknell's consonant sandhi table.  In all but 3 of these cases, scharfsandhi computed the
same result as the table.
Here are the three differences.

1. t S -> c C (Bucknell)  c S (Scharfsandhi)
   Note that ScharfSandhi computes t Sa -> c Ca;  in other words, the two agree when the 2nd word is followed by a vowel.
2. n S -> Y C (Bucknell)  Y S (Scharfsandhi)
   In contrast to case 1, using 'Sa' here has no change in Scharfsandhi.  This appears to be a real difference.
3. n l -> M l (Bucknell)  l~ l (Scharfsandhi).   
   In footnote 5, Bucknell mentions the nasalized l as an alternative.  
4. Footnote 6 indicates a difference (not captured in the comparison).  
   Bucknell's example (-in e -> -inn e) differences from the E1 option of sharf sandhi, which gives (in e -> in e).
   However, scharfsandhi does give (iN e -> iNN e), in agreement with Bucknell. 

### Possible additional options to Scharfsandhi
The footnotes 3,4,5 indicate optional sandhi combinations that are not reachable by the current scharfsandhi program.

### Summary of differences - vowel sandhi
This is a review of the log_vowel_test.txt summary file.

121 cases are derived from Bucknell's vowel sandhi table.  In all but 10 of these cases, scharfsandhi computed the
same result as the table.

Here are the differences.


